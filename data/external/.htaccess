# CORS Headers for External File Access
# Allow cross-origin requests for .exe, .pdf, .accdb, and .zip files

# Enable CORS for all origins (adjust as needed for security)
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, OPTIONS"
Header always set Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Range"
Header always set Access-Control-Expose-Headers "Content-Length, Content-Range"

# Handle preflight OPTIONS requests
RewriteEngine On
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Set proper MIME types for file types
<FilesMatch "\.exe$">
    Header always set Content-Type "application/octet-stream"
    Header always set Content-Disposition "attachment"
</FilesMatch>

<FilesMatch "\.pdf$">
    Header always set Content-Type "application/pdf"
</FilesMatch>

<FilesMatch "\.accdb$">
    Header always set Content-Type "application/msaccess"
    Header always set Content-Disposition "attachment"
</FilesMatch>

<FilesMatch "\.zip$">
    Header always set Content-Type "application/zip"
    Header always set Content-Disposition "attachment"
</FilesMatch>

# Security: Prevent directory listing
Options -Indexes

# Allow direct file access
<Files "*">
    Require all granted
</Files> 