<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jet Lag Research Survey - JetLagPro</title>
    
    <!-- Aggressive cache busting -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="Help advance chronoacupuncture research by participating in our jet lag survey. Your feedback helps improve jet lag management for travelers worldwide.">
    <meta name="keywords" content="jet lag research, chronoacupuncture survey, travel research, jet lag study">
    <script>
        // Eternal cache busting solution - auto-generates timestamp
        const cacheVersion = Math.floor(Date.now() / 1000);
        document.write('<link rel="stylesheet" href="survey.css?v=' + cacheVersion + '">');
    </script>
    <script src="load-common-head.js"></script>
</head>
<body>
    <div id="main-header"></div>

    <main>
        <section class="hero-simple">
            <div class="container">
                <h1>Jet Lag Research Survey</h1>
                <p class="hero-subtitle">Help advance chronoacupuncture research and improve jet lag management for travelers worldwide.</p>
            </div>
        </section>

        <div class="survey-main-column">
            <section class="survey-intro survey-card">
                <div class="container">
                    <div class="intro-content">
                        <h2>About This Research</h2>
                        <p>JetLagPro is conducting research to evaluate the effectiveness of chronoacupuncture for jet lag management. Your participation helps advance our understanding of this traditional Chinese medicine approach.</p>
                        
                        <div class="research-goals">
                            <h3>Research Goals:</h3>
                            <ul>
                                <li>Evaluate chronoacupuncture effectiveness for jet lag</li>
                                <li>Understand individual variation in treatment response</li>
                                <li>Identify optimal usage patterns for travelers</li>
                                <li>Improve jet lag management for future users</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Survey Preview Section -->
            <section class="survey-preview survey-card">
                <div class="container">
                    <div class="preview-content">
                        <h2>Survey Preview</h2>
                        <p>Below is a preview of the research survey questions. To participate in the actual survey and contribute to our research, you'll need a survey code from the JetLagPro app.</p>
                        
                        <div class="preview-notice">
                            <div class="notice-box">
                                <h4>ðŸ”¬ Research Participation</h4>
                                <p>This survey is part of ongoing research into chronoacupuncture for jet lag management. To participate:</p>
                                <ol>
                                    <li>Download the JetLagPro app</li>
                                    <li>Complete a journey in the app</li>
                                    <li>Click the survey link in the app</li>
                                </ol>
                                <p>Or</p>
                                <ol>
                                    <li>Get the survey code from the app</li>
                                    <li>Return here and enter the code in the box just below</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div class="code-input-section">
                            <label for="surveyCode">Survey Code (Required for Submission):</label>
                            <input type="text" id="surveyCode" placeholder="Enter your survey code (e.g., JLP-XXXXXXXX)" maxlength="12">
                            <button type="button" id="validateCode" class="btn btn-primary">Enable Survey Submission</button>
                        </div>
                        
                        <div id="validationMessage" class="validation-message"></div>
                    </div>
                </div>
            </section>

            <!-- Survey Content (always visible, but submission disabled without code) -->
            <div id="surveyContent" class="survey-layout-container survey-card">

                    <!-- LJLQ-based survey - Single scrollable form -->
                    <div class="survey-content">
                      <h3>Jet Lag Questions</h3>
                      <p>&nbsp;</p>
                      <form id="travelForm">
                        <div class="symptom-group">
                          <h4>Sleep disturbance</h4>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="sleep_pre" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Pre-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="sleep_expectations" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Expectations</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="sleep_post" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Post-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="symptom-group">
                          <h4>Daytime fatigue</h4>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="fatigue_pre" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Pre-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="fatigue_expectations" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Expectations</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="fatigue_post" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Post-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="symptom-group">
                          <h4>Difficulty concentrating</h4>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="concentration_pre" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Pre-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="concentration_expectations" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Expectations</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="concentration_post" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Post-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="symptom-group">
                          <h4>Irritability</h4>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="irritability_pre" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Pre-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="irritability_expectations" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Expectations</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="irritability_post" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Post-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="symptom-group">
                          <h4>Gastrointestinal issues</h4>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="gi_pre" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Pre-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="gi_expectations" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Expectations</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                          <div class="symptom-row">
                            <div class="scale-container">
                              <input type="range" name="gi_post" min="1" max="5" value="1" class="scale-slider">
                              <div class="scale-labels">
                                <span>None</span>
                                <span>Post-travel</span>
                                <span>Severe</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <h3 style="margin-top: 40px;">Flight Info</h3>
                      <p>Please provide details about your travel experience and app usage:</p>
                      <form id="contextForm">
                        <div class="context-row">
                          <label>Flight arrival date <span style="color: #e74c3c; font-weight: bold;">*</span></label>
                          <input type="date" name="flight_landing_date" required>
                        </div>
                        <div class="context-row">
                          <label>Approximate arrival hour <span style="color: #e74c3c; font-weight: bold;">*</span></label>
                          <select name="flight_landing_hour" required>
                            <option value="">Select hour</option>
                            <option value="0">00:00 (Midnight)</option>
                            <option value="1">01:00</option>
                            <option value="2">02:00</option>
                            <option value="3">03:00</option>
                            <option value="4">04:00</option>
                            <option value="5">05:00</option>
                            <option value="6">06:00</option>
                            <option value="7">07:00</option>
                            <option value="8">08:00</option>
                            <option value="9">09:00</option>
                            <option value="10">10:00</option>
                            <option value="11">11:00</option>
                            <option value="12">12:00 (Noon)</option>
                            <option value="13">13:00</option>
                            <option value="14">14:00</option>
                            <option value="15">15:00</option>
                            <option value="16">16:00</option>
                            <option value="17">17:00</option>
                            <option value="18">18:00</option>
                            <option value="19">19:00</option>
                            <option value="20">20:00</option>
                            <option value="21">21:00</option>
                            <option value="22">22:00</option>
                            <option value="23">23:00</option>
                          </select>
                        </div>
                        <div class="context-row">
                          <label>Destination airport code</label>
                          <input type="text" name="destination" placeholder="e.g., LHR, JFK, LAX" maxlength="3" style="text-transform: uppercase;">
                          <small style="color: #666; font-size: 0.9em;">3-letter airport code (e.g., LHR for London Heathrow)</small>
                        </div>
                        <div class="context-row">
                          <label>Direction of travel</label>
                          <select name="direction">
                            <option value="east">Eastward</option>
                            <option value="west">Westward</option>
                            <option value="both">Both</option>
                            <option value="not_sure">Not sure</option>
                          </select>
                        </div>
                        <div class="context-row">
                          <label>Number of time zones crossed</label>
                          <select name="timezones">
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12+">12+</option>
                          </select>
                        </div>
                        <div class="context-row">
                          <label>Flight duration (hours)</label>
                          <select name="flight_duration">
                            <option value="">Select flight duration</option>
                            <option value="1">1 hour</option>
                            <option value="2">2 hours</option>
                            <option value="3">3 hours</option>
                            <option value="4">4 hours</option>
                            <option value="5">5 hours</option>
                            <option value="6">6 hours</option>
                            <option value="7">7 hours</option>
                            <option value="8">8 hours</option>
                            <option value="9">9 hours</option>
                            <option value="10">10 hours</option>
                            <option value="11">11 hours</option>
                            <option value="12">12 hours</option>
                            <option value="13">13 hours</option>
                            <option value="14">14 hours</option>
                            <option value="15">15 hours</option>
                            <option value="16">16 hours</option>
                            <option value="17">17 hours</option>
                            <option value="18">18 hours</option>
                            <option value="19">19 hours</option>
                            <option value="20">20 hours</option>
                            <option value="21">21 hours</option>
                            <option value="22">22 hours</option>
                            <option value="23">23 hours</option>
                            <option value="24">24+ hours</option>
                          </select>
                        </div>
                        <div class="context-row">
                          <label>How many acupressure points did you stimulate (total)?</label>
                          <select name="points_total" required>
                            <option value="">Select number of points</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                          </select>
                        </div>
                        <div class="context-row">
                          <label>How many hours did you sleep during the flight?</label>
                          <select name="sleep_hours">
                            <option value="">Select sleep hours</option>
                            <option value="0">0 hours</option>
                            <option value="1">1 hour</option>
                            <option value="2">2 hours</option>
                            <option value="3">3 hours</option>
                            <option value="4">4 hours</option>
                            <option value="5">5 hours</option>
                            <option value="6">6 hours</option>
                            <option value="7">7 hours</option>
                            <option value="8">8 hours</option>
                            <option value="9">9 hours</option>
                            <option value="10">10+ hours</option>
                          </select>
                        </div>
                      </form>
                      <h3 style="margin-top: 40px;">Demographics</h3>
                      <form id="demographicsForm">
                        <div class="demographic-row">
                          <label>Age range</label>
                          <select name="age_range">
                            <option value="lt18">&lt;18</option>
                            <option value="18-24">18â€“24</option>
                            <option value="25-34">25â€“34</option>
                            <option value="35-44">35â€“44</option>
                            <option value="45-54">45â€“54</option>
                            <option value="55-64">55â€“64</option>
                            <option value="65+">65+</option>
                          </select>
                        </div>
                        <div class="demographic-row">
                          <label>Gender</label>
                          <select name="gender">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="nonbinary">Non-binary</option>
                            <option value="notsay">Prefer not to say</option>
                          </select>
                        </div>
                        <div class="demographic-row">
                          <label>Travel experience</label>
                          <select name="travel_experience">
                            <option value="novice">Novice</option>
                            <option value="occasional">Occasional</option>
                            <option value="frequent">Frequent</option>
                            <option value="very_frequent">Very frequent</option>
                          </select>
                        </div>
                        <div class="demographic-row">
                          <label>Geographic region</label>
                          <select name="region">
                            <option value="na">North America</option>
                            <option value="eu">Europe</option>
                            <option value="asia">Asia</option>
                            <option value="oceania">Oceania</option>
                            <option value="africa">Africa</option>
                            <option value="sa">South America</option>
                            <option value="other">Other</option>
                          </select>
                        </div>
                        <div class="demographic-row">
                          <label>Primary travel purpose</label>
                          <select name="purpose">
                            <option value="business">Business</option>
                            <option value="leisure">Leisure</option>
                            <option value="family">Family</option>
                            <option value="other">Other</option>
                          </select>
                        </div>
                      </form>
                        <h3 style="margin-top: 40px;">Comments</h3>
                        <p>Please share any additional thoughts about your experience using our app</p>
                        
                        <div class="comment-container">
                            <label for="userComment">Comments:</label>
                            <textarea 
                                id="userComment" 
                                name="userComment" 
                                placeholder="Share your experience, suggestions, or any additional thoughts about chronoacupuncture and jet lag management..."
                                maxlength="1000"
                                rows="4"
                                style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"
                            ></textarea>
                            <div class="comment-counter">
                                <span id="commentCharCount">0</span>/1000 characters
                            </div>
                            <div class="comment-note">
                                <small>ðŸ’¡ Your comments are anonymous and will be used for research purposes only.</small>
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <div style="margin-top: 40px; padding: 30px; text-align: center; border-top: 2px solid #e5e7eb; background: #f9fafb;">
                            <button 
                                id="submitSurveyBtn"
                                onclick="submitSurvey()" 
                                style="
                                    background: #10b981;
                                    color: white;
                                    border: none;
                                    padding: 15px 40px;
                                    border-radius: 8px;
                                    font-size: 18px;
                                    font-weight: bold;
                                    cursor: pointer;
                                    transition: background-color 0.3s ease;
                                "
                                onmouseover="this.style.background='#059669'"
                                onmouseout="this.style.background='#10b981'"
                            >
                                ðŸš€ Submit Survey
                            </button>
                            <p style="margin-top: 15px; color: #6b7280; font-size: 14px;">
                                Make sure you've entered a valid survey code above before submitting.
                            </p>
                        </div>
                    </div> <!-- End survey-content -->

                    <div class="survey-complete survey-card" id="surveyComplete" style="display: none;">
                        <div class="completion-content">
                            <div class="completion-icon">ðŸŽ‰</div>
                            <h2>Survey Complete!</h2>
                            <p>Thank you for participating in our research. Your feedback will help improve jet lag management for travelers worldwide.</p>
                            
                            <div class="completion-benefits">
                                <h3>What happens next:</h3>
                                <ul>
                                    <li>âœ… Your anonymous data will be analyzed for research purposes</li>
                                    <li>âœ… You'll receive free access to the final version of JetLagPro</li>
                                    <li>âœ… Research results will be published to advance jet lag science</li>
                                    <li>âœ… Your contribution helps future travelers</li>
                                </ul>
                            </div>
                            
                            <div class="completion-actions">
                                <a href="index.html" class="btn btn-primary">Return to JetLagPro</a>
                                <a href="research-paper.html" class="btn btn-secondary" target="_blank">Read Our Research Paper</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 JetLagPro. All rights reserved. | <a href="privacy.html">Privacy Policy</a></p>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import the functions you need from the SDKs
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, doc, updateDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBcck2Ca7xBjlZcCwTcQBNQUueFsO0wyBA",
            authDomain: "jetlagpro-research.firebaseapp.com",
            projectId: "jetlagpro-research",
            storageBucket: "jetlagpro-research.firebasestorage.app",
            messagingSenderId: "202766013439",
            appId: "1:202766013439:web:c835e22cf3a12332920dca",
            measurementId: "G-8JV71DX3W3"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Make Firebase available globally for survey.js
        window.firebaseApp = app;
        window.firebaseDB = db;
        window.firebaseCollection = collection;
        window.firebaseAddDoc = addDoc;
        window.firebaseDoc = doc;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseServerTimestamp = serverTimestamp;

        console.log('ðŸ”¥ Firebase initialized successfully');
    </script>
          <script>
          // Eternal cache busting for JavaScript - auto-generates timestamp
          const jsVersion = Math.floor(Date.now() / 1000);
          document.write('<script src="survey.js?v=' + jsVersion + '"><\/script>');
      </script>
    
    <!-- Legacy cache refresh script removed - eternal cache busting now handles this -->
    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }
    </script>

    <div id="main-footer"></div>
    
    <!-- Centralized Components (Header/Footer) -->
    <script src="js/components.js"></script>
    
    <!-- Google Translate (Centralized) -->
    <script src="js/translate.js"></script>
</body>
</html> 